var $solitics={transactions:{},solitics_configuration:{brand:"",memberId:"",email:"",popuptoken:""},onlineApiDetails:{url:"https://api.solitics.com/rest/integrations/transaction",optinUrl:"https://api.solitics.com/rest/optin/systemMessage",popupUrl:"https://api.solitics.com/rest/promotions/registerNonCustomUserEventWithContentId"},socketDetails:{url:"wss://wss.solitics.com:8080",popup:{},ws:{}},popupModals:{modal:null,modal_content:null,iframe:null,iframedoc:null,closeButton:null},modal_msg:{},init:function(o){$solitics_init(o)},init_popup:function(o){$solitics_init_popup(o)},onLoginSuccess:function(o,i,t,s){$solitics_onLogInSuccess(o,i,t,s)},loginSuccess:function(o){$solitics_onLogInSuccessWithObject(o)},onLogout:function(){$solitics_onLogout()},emitWithTransactionId:function(o,i,t,s){$solitics_emit_withId(o,i,t,s)},emit:function(o,i,t){$solitics_emit(o,i,t)},onPageEnter:function(o,i){$solitics_onPageEnter(o,i)},onPageLeave:function(o,i){$solitics_onPageLeave(o,i)},onClick:function(o,i){$solitics_onClick(o,i)},optinToPromotion:function(o,i,t){$solitics_optinToPromotion(o,i,t)},hidePopup:function(){$solitics_hidePopup()}},TRANSACTIONS_QUEUE_NAME="solitics_transaction",SOLITICS_CONFIGURATION="solitics_configuration",isMobile={KindleSilk:function(){return navigator.userAgent.match(/Silk/i)},Kindle:function(){return navigator.userAgent.match(/Kindle/i)},Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.KindleSilk()||isMobile.Kindle()||isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};function getUserDevice(){var o=!1;return screen.width<800&&(o=!0),screen.height<800&&(o=!0),isMobile.any()?"mobile":o?"tablet":"desktop"}function $solitics_init(o){var i=localStorage.SOLITICS_CONFIGURATION;$solitics.solitics_configuration=i?JSON.parse(i):{brand:"",memberId:"",email:"",popuptoken:""},$solitics.solitics_configuration.brand=o,localStorage.SOLITICS_CONFIGURATION=JSON.stringify($solitics.solitics_configuration)}function $solitics_init_popup(o){var i=localStorage.SOLITICS_CONFIGURATION;$solitics.solitics_configuration=i?JSON.parse(i):{brand:"",memberId:"",email:"",popuptoken:""},$solitics.solitics_configuration.popuptoken=o,localStorage.SOLITICS_CONFIGURATION=JSON.stringify($solitics.solitics_configuration),$solitics_openWebSocket()}function $solitics_onInit(){document.querySelector("#solitics-popup-maker")||setTimeout(function(){$solitics_createPopupHTML(),$solitics.popupModals.modal=document.querySelector("#solitics-popup-maker.solitics-modal"),$solitics.popupModals.modal_content=document.querySelector("#solitics-popup-maker .solitics-modal-content"),$solitics.popupModals.iframe=document.querySelector("#solitics-iframe-popup"),$solitics.popupModals.closeButton=document.querySelector(".solitics-close-button"),$solitics.popupModals.closeButton.addEventListener("click",toggleModal),window.addEventListener("click",windowOnClick),$solitics.popupModals.iframe.addEventListener("load",soliticsOnLoadIframe),$solitics_clearPopupContent()},500)}function $solitics_onLogInSuccess(o,i,t,s){var e=localStorage.SOLITICS_CONFIGURATION;e&&($solitics.solitics_configuration=JSON.parse(e)),t&&($solitics.solitics_configuration.brand=t),$solitics.solitics_configuration.memberId=o,$solitics.solitics_configuration.email=i,localStorage.SOLITICS_CONFIGURATION=JSON.stringify($solitics.solitics_configuration),s&&$solitics_init_popup(s);var l=location.host+location.pathname,c=location.href,n={page:l};c&&(n.fullUrl=c),$solitics_beforeTransaction("LOGIN",n)}function $solitics_onLogInSuccessWithObject(o){if(o){var i=turnKeysToLower(o),t=localStorage.SOLITICS_CONFIGURATION;t&&($solitics.solitics_configuration=JSON.parse(t)),i.brand&&($solitics.solitics_configuration.brand=i.brand),$solitics.solitics_configuration.memberId=i.memberid,$solitics.solitics_configuration.email=i.email,$solitics.solitics_configuration.branch=i.branch,$solitics.solitics_configuration.keyType=i.keytype,$solitics.solitics_configuration.keyValue=i.keyvalue,localStorage.SOLITICS_CONFIGURATION=JSON.stringify($solitics.solitics_configuration),$solitics_onLogInSuccess(i.memberid,i.email,i.brand,i.popuptoken)}}function turnKeysToLower(o){for(var i,t=Object.keys(o),s=t.length,e={};s--;)e[(i=t[s]).toLowerCase()]=o[i];return e}function $solitics_onLogout(){$solitics_beforeTransaction("LOGOUT"),localStorage.removeItem("SOLITICS_CONFIGURATION"),localStorage.removeItem("TRANSACTIONS_QUEUE_NAME"),delete localStorage.SOLITICS_CONFIGURATION,delete localStorage.TRANSACTIONS_QUEUE_NAME,$solitics.solitics_configuration={brand:"",memberId:"",email:"",popuptoken:"",hashedSubscriberId:""},$solitics.socketDetails.ws&&$solitics.socketDetails.ws.onclose&&$solitics.socketDetails.ws.onclose()}function $solitics_createPopupHTML(){var o=document.createElement("style");o.type="text/css",o.innerHTML="#solitics-popup-maker { position: fixed; left: 0; top: 0; width: 100%; height: 100%; opacity: 0; display:none; visibility: hidden; transform: scale(1.1); transition: visibility 0s linear 0.25s, opacity 0.25s 0s, transform 0.25s; } #solitics-popup-maker.solitics-modal { background-color: rgba(0, 0, 0, 0.6); z-index:9999; } #solitics-popup-maker .solitics-modal-content { position: absolute; top: 55%; left: 50%; transform: translate(-50%, -50%); min-width: 25rem; width: auto; height: auto; max-height: 75%; } #solitics-popup-maker.solitics-modal-xsm .solitics-modal-content { width: 30%; /*height: 30%;*/ } #solitics-popup-maker.solitics-modal-xsm .solitics-modal-content.left{ left: 16%; } #solitics-popup-maker.solitics-modal-xsm .solitics-modal-content.right{ left: 83%; } #solitics-popup-maker.solitics-modal-xsm .solitics-modal-content.top-right{ left: 83%; top: 19%; } #solitics-popup-maker.solitics-modal-xsm .solitics-modal-content.top-left{ left: 16%; top: 19%; } #solitics-popup-maker.solitics-modal-xsm .solitics-modal-content.bottom-right{ left: 83%; top: 85%; } #solitics-popup-maker.solitics-modal-xsm .solitics-modal-content.bottom-left{ left: 16%; top: 85%; } #solitics-popup-maker.solitics-modal-sm .solitics-modal-content { width: 45%; /*height: 45%;*/ } #solitics-popup-maker.solitics-modal-sm .solitics-modal-content.left{ left: 23%; } #solitics-popup-maker.solitics-modal-sm .solitics-modal-content.right{ left: 75%; } #solitics-popup-maker.solitics-modal-sm .solitics-modal-content.top-right{ left: 75%; top: 26%; } #solitics-popup-maker.solitics-modal-sm .solitics-modal-content.top-left{ left: 23%; top: 26%; } #solitics-popup-maker.solitics-modal-sm .solitics-modal-content.bottom-right{ left: 75%; top: 77%; } #solitics-popup-maker.solitics-modal-sm .solitics-modal-content.bottom-left{ left: 23%; top: 77%; } #solitics-popup-maker.solitics-modal-md .solitics-modal-content { width: 70%; /*height: 70%;*/ } #solitics-popup-maker.solitics-modal-md .solitics-modal-content.left{ left: 35%; } #solitics-popup-maker.solitics-modal-md .solitics-modal-content.right{ left: 63%; } #solitics-popup-maker.solitics-modal-md .solitics-modal-content.top-right{ left: 63%; top: 38%; } #solitics-popup-maker.solitics-modal-md .solitics-modal-content.top-left{ left: 35%; top: 38%; } #solitics-popup-maker.solitics-modal-md .solitics-modal-content.bottom-right{ left: 63%; top: 65%; } #solitics-popup-maker.solitics-modal-md .solitics-modal-content.bottom-left{ left: 35%; top: 65%; } #solitics-popup-maker.solitics-modal-lg .solitics-modal-content { width: 90%; /*height: 90%;*/ } #solitics-popup-maker.solitics-modal-lg .solitics-modal-content.left{ left: 45%; } #solitics-popup-maker.solitics-modal-lg .solitics-modal-content.right{ left: 53%; } #solitics-popup-maker.solitics-modal-lg .solitics-modal-content.top-right{ left: 53%; top: 48%; } #solitics-popup-maker.solitics-modal-lg .solitics-modal-content.top-left{ left: 45%; top: 48%; } #solitics-popup-maker.solitics-modal-lg .solitics-modal-content.bottom-right{ left: 53%; top: 54%; } #solitics-popup-maker.solitics-modal-lg .solitics-modal-content.bottom-left{ left: 45%; top: 54%; } #solitics-popup-maker #solitics-modal-body.solitics-modal-msg{ /*height: 100%;*/ } #solitics-popup-maker .solitics-close-button { float: right; line-height: 1.4rem; text-align: center; cursor: pointer; border-radius: 0.25rem; margin-top: -18px; margin-right: -26px; border-radius: 56%; color: #fff; width: 25px;height: 25px;font-size: 20px; position: absolute; right: 0px; top: -6px;} #solitics-popup-maker .solitics-close-button:hover { background-color: darkgray; } #solitics-popup-maker.solitics-show-modal { opacity: 1; visibility: visible; transform: scale(1.0); transition: visibility 0s linear 0s, opacity 0.25s 0s, transform 0.25s; display: block; } #solitics-popup-maker .solitics-iframe-content{ width: 100%; height: 100%; border: none; } ",document.getElementsByTagName("head")[0].appendChild(o);var i=document.createElement("div");i.setAttribute("id","solitics-popup-maker"),i.classList.add("solitics-modal"),i.style.cssText="",document.body.appendChild(i);var t=document.createElement("div");t.classList.add("solitics-modal-content"),t.style.cssText="",i.appendChild(t);var s=document.createElement("div");s.classList.add("solitics-close-button"),s.innerHTML="&times;",t.appendChild(s);var e=document.createElement("div");e.setAttribute("id","solitics-modal-body"),e.classList.add("solitics-modal-msg"),t.appendChild(e),$solitics.modal_msg=e;var l=document.createElement("iframe");l.setAttribute("id","solitics-iframe-popup"),l.setAttribute("name","solitics-iframe-popup"),l.classList.add("solitics-iframe-content"),e.appendChild(l)}function $solitics_send(o){if(1===$solitics.socketDetails.ws.readyState)try{$solitics.socketDetails.ws.send(o)}catch(o){console.log("WebSocket is closed now.",o)}else setTimeout(function(){$solitics_send(o)},1e3)}function $solitics_openWebSocket(){if($solitics_onInit(),"WebSocket"in window){if((!$solitics.socketDetails.ws||1!==$solitics.socketDetails.ws.readyState)&&$solitics.solitics_configuration.popuptoken&&$solitics.solitics_configuration.hashedSubscriberId){try{$solitics.socketDetails.ws=new WebSocket($solitics.socketDetails.url)}catch(o){}$solitics.socketDetails.ws.onopen=function(){var o={requestType:"connect",credentials:{token:$solitics.solitics_configuration.popuptoken,memberId:$solitics.solitics_configuration.memberId,hashedSubscriberId:$solitics.solitics_configuration.hashedSubscriberId}};$solitics_send(JSON.stringify(o))},$solitics.socketDetails.ws.onmessage=function(o){$solitics.socketDetails.popup=JSON.parse(o.data),renderIframe();var i=1,t=setInterval(function(){15==i&&clearInterval(t),$solitics.popupModals.iframedoc=$solitics.popupModals.iframe.contentDocument||$solitics.popupModals.iframe.contentWindow&&$solitics.popupModals.iframe.contentWindow.document;var o=getDocHeight($solitics.popupModals.iframedoc);$solitics.popupModals.iframe.style.height=o+"px",$solitics.popupModals.iframe.parentElement.style.height=o+"px",$solitics.popupModals.iframe.style.transition="all 0.3s ease-in-out",i++,"0px"==$solitics.popupModals.iframe.style.height&&($solitics.popupModals.iframe.style.height="75vh")},200)},$solitics.socketDetails.ws.onclose=function(o){setTimeout(function(){$solitics_openWebSocket()},5e3)},$solitics.socketDetails.ws.onerror=function(o){}}}else console.log("WebSocket NOT supported by your Browser!")}function renderIframe(){$solitics.socketDetails.popup.html&&($solitics_clearPopupContent(),$solitics_createPopup(),$solitics.popupModals.modal.classList.contains("solitics-show-modal")||(toggleModal(),sendMetric("delivered")))}function soliticsOnLoadIframe(){var o=this.contentDocument||this.contentWindow.document;if(aTags=o.getElementsByTagName("a"),aTags&&0<aTags.length)for(var i=0;i<aTags.length;i++)aTags[i].addEventListener("click",function(){onPopupClickEvt(this,"aTags click Detected!")},!1);if(buttonTags=o.getElementsByTagName("button"),buttonTags&&0<buttonTags.length)for(i=0;i<buttonTags.length;i++)buttonTags[i].addEventListener("click",function(){onPopupClickEvt(this,"buttonTags click Detected!")},!1);if(imgTags=o.getElementsByTagName("img"),imgTags&&0<imgTags.length)for(i=0;i<imgTags.length;i++)imgTags[i].addEventListener("click",function(){onPopupClickEvt(this,"imgTags click Detected!")},!1);if(bgImageElements=o.querySelectorAll('*[style*="background-image"]'),bgImageElements&&0<bgImageElements.length)for(i=0;i<bgImageElements.length;i++)bgImageElements[i].addEventListener("click",function(){onPopupClickEvt(this,"bgImageElements click Detected!")},!1)}function onPopupClickEvt(o,i){console.log(i);o.getAttribute("id"),o.getAttribute("name"),o.getAttribute("class");$solitics_clickPopup()}function sendMetric(o){var i={requestType:"metric",messageId:$solitics.socketDetails.popup.id,metric:o};$solitics.socketDetails.ws.send(JSON.stringify(i))}function windowOnClick(o){o.target===$solitics.popupModals.modal&&toggleModal()}function toggleModal(){$solitics.popupModals.modal.classList.toggle("solitics-show-modal"),$solitics.popupModals.modal.classList.contains("solitics-show-modal")?(sendMetric("open"),console.log("solitics modal opened")):(sendMetric("closed"),console.log("solitics modal closed"))}function windowOnClick(o){o.target===$solitics.popupModals.modal&&toggleModal()}function getDocHeight(o){var i,t=(o=o||document).body;o.documentElement;return t&&(i=Math.max(t.clientHeight,t.scrollHeight,t.offsetHeight)),i}function $solitics_clearPopupContent(){$solitics.popupModals.iframedoc=$solitics.popupModals.iframe.contentDocument||$solitics.popupModals.iframe.contentWindow&&$solitics.popupModals.iframe.contentWindow.document,$solitics.popupModals.iframedoc&&$solitics.popupModals.iframedoc.body&&($solitics.popupModals.iframedoc.body.innerHTML=""),$solitics.popupModals.iframe.srcdoc="",$solitics.popupModals.modal.classList.contains("solitics-show-modal")&&($solitics.popupModals.modal.classList.remove("solitics-show-modal"),console.log("solitics modal closed"))}function $solitics_createPopup(){initPopupSetting(),$solitics.popupModals.iframedoc=$solitics.popupModals.iframe.contentDocument||$solitics.popupModals.iframe.contentWindow&&$solitics.popupModals.iframe.contentWindow.document;var o=$solitics.socketDetails.popup.html;if($solitics.popupModals.iframedoc.open(),$solitics.popupModals.iframedoc.write(o),$solitics.popupModals.iframedoc.close(),$solitics.popupModals.iframedoc){if($solitics.popupModals.iframedoc.body){var i=$solitics.popupModals.iframedoc.body.offsetHeight;$solitics.popupModals.iframe.style.height=i+"px",$solitics.popupModals.iframe.parentElement.style.height=i+"px",$solitics.popupModals.iframe.style.maxHeight="75vh"}var t=document.createElement("style");t.type="text/css",t.innerHTML="body { overflow-x: hidden; text-align: center; } body::-webkit-scrollbar-track { border-radius: 10px; margin:7px 0; background-color: rgba(27, 30, 50, 0.15); } body::-webkit-scrollbar { width: 5px; background-color: transparent; } body::-webkit-scrollbar-thumb { border-radius: 10px; background-color: rgba(27, 30, 50, 0.3); } ",frames["solitics-iframe-popup"].document.head.appendChild(t)}}function initPopupSetting(){if($solitics.socketDetails.popup.position&&($solitics.popupModals.modal_content.classList.remove("center","left","right","top-right","top-left","bottom-right","bottom-left"),$solitics.popupModals.modal_content.classList.add($solitics.socketDetails.popup.position)),$solitics.socketDetails.popup.theme)switch(getUserDevice()){case"mobile":$solitics_fillPopUpByTheme($solitics.socketDetails.popup.theme.deviceToPopupTheme.mobile,"mobile");break;case"tablet":$solitics_fillPopUpByTheme($solitics.socketDetails.popup.theme.deviceToPopupTheme.tablet,"tablet");break;case"desktop":default:$solitics_fillPopUpByTheme($solitics.socketDetails.popup.theme.deviceToPopupTheme.desktop,"desktop")}}function $solitics_fillPopUpByTheme(o,i){var t;if(0<o.size&&($solitics.popupModals.modal_content.style.width=o.isFixedSize?o.size+"px":o.size+"%"),o.backdrop&&!o.backdrop.enabled?$solitics.popupModals.modal.style.backgroundColor="unset":o.backdrop&&o.backdrop.enabled&&($solitics.popupModals.modal.style.backgroundColor="rgba(0, 0, 0,"+o.backdrop.value/100+")"),o.border){var s=o.border.width?o.border.width+"px solid":"0px solid",e=o.border.color?o.border.color:"none";$solitics.popupModals.modal_content.style.border=s+e,t=e}o.border.radius&&($solitics.popupModals.modal_content.style.borderRadius=o.border.radius+"px"),o.exitButton&&!o.exitButton.enabled?$solitics.popupModals.closeButton.style.display="none":(o.exitButton&&o.exitButton.enabled&&o.exitButton.inside?($solitics.popupModals.closeButton.style.top="unset",$solitics.popupModals.closeButton.style.marginTop="0px",$solitics.popupModals.closeButton.style.marginRight="0px",$solitics.popupModals.closeButton.style.color=o.exitButton.color?o.exitButton.color:"inherit",$solitics.popupModals.closeButton.style.border=o.exitButton.border?"2px solid":"none",$solitics.popupModals.closeButton.style.display="inline-block"):($solitics.popupModals.closeButton.style.display="inline-block",$solitics.popupModals.closeButton.style.color=o.exitButton.color?o.exitButton.color:"inherit",$solitics.popupModals.closeButton.style.border=t&&o.exitButton.border?"2px solid"+t:"none"),$solitics.popupModals.closeButton.style.fontSize=o.exitButton.size?o.exitButton.size:"14px"),o.background&&!o.background.enabled&&o.background.color?$solitics.popupModals.modal_content.style.backgroundColor=o.background.color:o.background&&o.background.enabled&&($solitics.popupModals.modal_content.style.backgroundColor="#fff"),o.background&&o.background.shadow&&o.background.shadow.enabled?$solitics.popupModals.modal_content.style.boxShadow="0 3px 9px rgba(0, 0, 0, 0.5)":$solitics.popupModals.modal_content.style.boxShadow="none",$solitics.socketDetails.popup.theme.closeOnBackgroundClick&&($solitics.popupModals.modal.setAttribute("data-keyboard","false"),$solitics.popupModals.modal.setAttribute("data-backdrop","static"));var l=o.border.radius;switch(i){case"mobile":l-=4;break;case"tablet":l-=2;break;case"desktop":--l}$solitics.popupModals.iframe.style.borderRadius=l+"px"}function $solitics_emit_withId(o,i,t,s){var e,l=localStorage.SOLITICS_CONFIGURATION;l&&($solitics.solitics_configuration=JSON.parse(l)),e="string"==typeof s?JSON.parse(s):s,$solitics.solitics_configuration&&$solitics_transaction($solitics.solitics_configuration.brand,$solitics.solitics_configuration.memberId,$solitics.solitics_configuration.email,o,i,t,e)}function $solitics_emit(o,i,t,s){var e,l=localStorage.SOLITICS_CONFIGURATION;l&&($solitics.solitics_configuration=JSON.parse(l)),e="string"==typeof t?JSON.parse(t):t,$solitics.solitics_configuration&&$solitics_transaction($solitics.solitics_configuration.brand,$solitics.solitics_configuration.memberId,$solitics.solitics_configuration.email,null,o,i,e,s)}function $solitics_onPageEnter(o,i){var t;(t=(t="string"==typeof i?JSON.parse(i):i)||{}).page=o,$solitics_beforeTransaction("PAGE_ENTER",t)}function $solitics_onPageLeave(o,i){var t;(t=(t="string"==typeof i?JSON.parse(i):i)||{}).page=o,$solitics_beforeTransaction("PAGE_LEAVE",t)}function $solitics_onClick(o,i){var t;(t=(t="string"==typeof i?JSON.parse(i):i)||{}).buttonName=o,$solitics_beforeTransaction("BUTTON_CLICK",t)}function $solitics_optinToPromotion(o,i,t){var s=new XMLHttpRequest;s.open("POST",$solitics.onlineApiDetails.optinUrl,!0),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.onreadystatechange=function(){4===s.readyState&&200===s.status?(console.log("success optin"+o),console.log(s.responseText),i&&i(this)):4===s.readyState&&(console.log("error optin"+o),t&&t(this))};try{s.send(o)}catch(o){console.log(o)}}function $solitics_clickPopup(o,i){if($solitics_isValidRequestPopup()){var t=new XMLHttpRequest,s=$solitics.onlineApiDetails.popupUrl+"/"+$solitics.socketDetails.popup.webhookParams.subscriberId+"/"+$solitics.socketDetails.popup.webhookParams.promotion_id+"/"+$solitics.socketDetails.popup.webhookParams.content_id+"/POPUP/ESP_CLICK";t.open("POST",s,!0),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.onreadystatechange=function(){4===t.readyState&&200===t.status?(console.log("success clickPopup"),console.log(t.responseText),o&&o(this)):4===t.readyState&&(console.log("error clickPopup"),i&&i(this))};try{t.send()}catch(o){console.log(o)}}}function $solitics_hidePopup(){$solitics_clearPopupContent()}function $solitics_onAutoPageChange(o,i,t){var s={page:i};t&&(s.fullUrl=t),$solitics_beforeTransaction(o,s),$solitics.solitics_configuration&&$solitics.solitics_configuration.popuptoken&&$solitics.solitics_configuration.hashedSubscriberId&&$solitics_init_popup($solitics.solitics_configuration.popuptoken)}function guid(){function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function $solitics_beforeTransaction(o,i){var t=localStorage.SOLITICS_CONFIGURATION;t&&($solitics.solitics_configuration=JSON.parse(t)),$solitics.solitics_configuration&&$solitics_transaction($solitics.solitics_configuration.brand,$solitics.solitics_configuration.memberId,$solitics.solitics_configuration.email,null,o,0,i)}function $solitics_getQueueValue(o){var i=null;try{var t=localStorage.getItem(o);i=JSON.parse(t)}catch(o){}return i}function $solitics_getTransactionsQueueValue(){var o=$solitics_getQueueValue("TRANSACTIONS_QUEUE_NAME");return o||{}}document.addEventListener("click",function(o){o.target.closest("#solitics-popup-maker")&&$solitics.socketDetails&&$solitics.socketDetails.popup&&$solitics.socketDetails.popup.theme&&!$solitics.socketDetails.popup.theme.closeOnBackgroundClick&&o.stopPropagation()});var transactionsStorageUpdatedHandler=function(o){var i=$solitics_getTransactionsQueueValue(),t=Object.keys(i);if(0<t.length){var s=i[t[0]];s&&$solitics_sendTransaction(s.params,s.guid)}};function removeTransactionFromQueue(o){var i=null;try{(i=!!$solitics.transactions[o])&&(delete $solitics.transactions[o],localStorage.TRANSACTIONS_QUEUE_NAME=JSON.stringify($solitics.transactions),transactionsStorageUpdatedHandler())}catch(o){}return i}function $solitics_isValidRequestPopup(){var o=$solitics.socketDetails.popup.webhookParams.subscriberId,i=$solitics.socketDetails.popup.webhookParams.promotion_id,t=$solitics.socketDetails.popup.webhookParams.content_id,s=!!o&&!!i&&!!t;return o||(s=!1,console.log("missing subscriberId to transaction: "+o)),i||(s=!1,console.log("missing promotion_id to transaction: "+i)),t||(s=!1,console.log("missing content_id to transaction: "+t)),s}function $solitics_isValidRequest(o,i,t,s){var e=!!(o&&i&&t&&s);return o||(e=!1,console.log("missing brand to transaction: "+s)),i||(e=!1,$solitics.solitics_configuration.keyType&&$solitics.solitics_configuration.keyValue?e=!0:console.log("missing memberId to transaction: "+s)),t&&void 0!==t&&"undefined"!==t||(e=!1,console.log("missing email to transaction: "+s)),s||(e=!1,console.log("missing transactionType")),e}function $solitics_logTransactionInLocalStorage(o){var i={guid:guid(),params:o,status:"request",date:new Date};$solitics.transactions[i.guid]=i,localStorage.TRANSACTIONS_QUEUE_NAME=JSON.stringify($solitics.transactions),transactionsStorageUpdatedHandler()}function $solitics_sendTransaction(o,i,t){var s=new XMLHttpRequest;s.open("POST",$solitics.onlineApiDetails.url,!0),s.setRequestHeader("Content-Type","application/json;charset=UTF-8"),s.onreadystatechange=function(){4===s.readyState&&200===s.status?(console.log("success "+o.transactionType),console.log(s.responseText),$solitics.solitics_configuration&&s.responseText&&$solitics.solitics_configuration.popuptoken&&!$solitics.solitics_configuration.hashedSubscriberId&&$solitics_init_popup($solitics.solitics_configuration.popuptoken),$solitics.solitics_configuration.hashedSubscriberId=s.responseText,localStorage.SOLITICS_CONFIGURATION=JSON.stringify($solitics.solitics_configuration),removeTransactionFromQueue&&removeTransactionFromQueue(i)):4===s.readyState&&console.log(s.responseText)};try{s.send(JSON.stringify(o))}catch(o){console.log(o)}}function $solitics_transaction(o,i,t,s,e,l,c,n){if($solitics_isValidRequest(o,i,t,e)){var a={brand:o,token:o,memberId:i,email:t,transactionId:s||guid(),transactionType:e,transactionAmount:l||0};c&&(a.customFields=JSON.stringify(c).toString()),$solitics.solitics_configuration.branch&&(a.branch=$solitics.solitics_configuration.branch),$solitics.solitics_configuration.keyType&&$solitics.solitics_configuration.keyValue&&(a.keyType=$solitics.solitics_configuration.keyType,a.keyValue=$solitics.solitics_configuration.keyValue),$solitics_logTransactionInLocalStorage(a)}}function locationHashChanged(){$solitics_onAutoPageChange("AUTO_PAGE_CHANGE",location.host+location.pathname,location.href)}function $solitics_init_internal(){$solitics.solitics_configuration&&$solitics.solitics_configuration.hashedSubscriberId&&$solitics.solitics_configuration.popuptoken&&$solitics_openWebSocket()}function onLoadPage(){$solitics_init_internal(),$solitics_onAutoPageChange("AUTO_PAGE_CHANGE",location.host+location.pathname,location.href)}locationHashChanged(),onLoadPage(),window.unload=function(o){$solitics_onLogout()};
